---
title: Breathing peak Flow # Geef je paper een naam die prikkelt, informatief is, en zo kort mogelijk
authors: "<Daniël: 452871, Larissa: 432995 en Marian:446030 >"
author: |
  | Daniël Pastoor $^1$, Larissa Voshol Feenstra $^1$, Marian Hasan $^1$
  | $^1$Hanzehogeschool

lang: en

abstract: |
  Geef hier je samenvatting in maximaal 150 woorden. Het is een samenvatting van het hele artikel; niet alleen de resultaten! Begin met het belang van dit onderzoek, dan hoe het onderzoek is aangepakt en de belangrijkste resultaten en eindig met de implicaties ervan voor de wetenschap/de maatschappij. Neem nooit figuren of tabellen op in de samenvatting.

bibliography: breathing_peak_flow.bib # naam van je .bib file. Deze moet hetzelfde zijn als je Rmd bestandsnaam

output:
  bookdown::pdf_document2:
    keep_tex: false    # set this to true if you want to investigate the generated tex
    toc: false         # table of contents
    fig_caption: true  # includes figure captions with numbering in output
    includes:  
        in_header: include_tex_header.tex #will include rules for linespacing and figure floating

---

```{r setup, message=FALSE, warning=FALSE, include=FALSE}
knitr::opts_chunk$set(out.width = '100%', dpi=300) # configuratie voor figuur grootte en resolutie
knitr::opts_chunk$set(echo = FALSE) # Deze regel zorgt ervoor GEEN ENKELE chunk getoond wordt! 
# Laad alle gebruikte bibliotheken hier
library(ggplot2)
library(dplyr)
library(tidyr)
#devtools::install_github("benmarwick/wordcountaddin", type = "source", dependencies = TRUE)
```

```{r data-reading, warning=FALSE}
data_file <- "../raw_data/Data_breath.csv"

#data format: Subject_id,Sport,Sport_times,Age,Length,Weight,Sex,Peak_flow,Has_activity,Device_number
data_breath <- read.table(file = data_file,
                        header = TRUE,
                        sep = ",")
```

```{r data-verwerk, warning=FALSE}
# get mean of the 2 different data points
data_breath_diff <- data_breath %>% group_by(Subject_id) %>% mutate(Diff_peak_flow = Peak_flow[2] - Peak_flow[1])

data_breath <-  data_breath %>%
  mutate( Sporting = case_when(Sport == "None" ~ F, .default = T))

data_breath <-  data_breath %>%
  mutate( Sporting_label = case_when(Sporting ~ "Sporting", .default = "Not sporting"))

# To add labels for the face_wrap
data_breath <-  data_breath %>%
  mutate( Has_activity_label = case_when(Has_activity == "True" ~ "After jumping jacks" , .default = "Before jumping jacks"))

# variable for man
data_breath_male <- data_breath %>%
  filter(Sex == "Man")

# variable for woman
data_breath_female <- data_breath %>%
  filter(Sex == "Woman")
```

# Introduction

Asthma is a chronic lung disease that causes the airways to be constantly inflamed. The disease can occur at any age but is mostly present in children and adolescents. Approximately 600.000 people in the Netherlands suffer from asthma, of which 80.000 are children.
In the year 2019 alone, the Dutch government has spent nearly 444 billion euros on asthma care. From this 444 billion euros, 40 percent was spent on medication. One of the symptoms of asthma that requires medical aid is shortness of breath, which is caused by the narrowing of the airways due to muscle tightening or inflammation. 
Research has proven that exercising can improve asthma control in patients, but that it has little to no effect on one's peak expiratory flow rate  (PEFR). 
The PEFR is the maximum rate of airflow that a person can forcefully exhale. The PEFR can reliably indicate the adequacy of someone’s ventilation and whether or not someone suffers from airflow obstruction.
This experiment was conducted out of pure curiosity. However, if exercising does turn out to significantly increase one’s PEFR, and dilate their airways, it could help reduce shortness of breath in patients thereby reducing the costs of asthma care.
A healthy PEFR ranges between 400 and 600 litres per minute. A PEFR between 200 and 400 litres per minute can indicate asthma.
A healthy PEFR varies from person to person and is also influenced by factors such as sex, age and height. The PEFR tends to be higher in males and taller people compared  to females and shorter people. The PEFR is measured using a Peak Flow Meter, a small device with a scale ranging from 50 L/min to 800 L/min. 
This paper aims to assess whether or not exercising can increase one’s PEFR. Additionally it will examine the effects of several factors on the PEFR.
To conduct this experiment the PEFR of students from the Hanze University  were measured using a Peak Flow Meter. These students were divided by sex and whether or not they participated in sports. Their PEFR’s were measured before and after asking them to perform 10 jumping jacks. 


# Materials and methods

Software:
 R
 Excel

Libraries:
Dplyr
Ggplot2
Tidyverse
Tidyr

Devices:
Peak flow meter
Disinfectant wipes
Laptop (for storing data)

To collect the data a peak flow meter, disinfectant wipes and a laptop have been used. The data was stored in an excel-file using a csv format. The specific steps in which the data has been collected can be found in the git repository.
The statistical programming language R has been used to process the data. The data has been plotted and visualised using the libraries dplyr, ggplot2 and tidyverse in R. Hypothesis testing of our data has also been achieved using R. The hypothesis tests used for this experiment were the Shapiro-Wilk test,  two-tailed t-test and ANOVA test.


The Shapiro-Wilk test was performed to determine whether or not the data was normally distributed. Data is normally distributed when most of the data points are in the middle of the range whilst the rest of the data points are in the two extremes.


The two-tailed t-test was performed on the factor jumping jacks. A two-tailed t-test is used to determine if there is a significant difference between groups in general, not specifically in one direction.


The ANOVA (Analysis Of Variance)  test was performed on the factors sport, sex and activity. An ANOVA test is used when comparing more than two means. The ANOVA test can be performed using more than one independent variable.


# Resultaten

De resultaten van het onderzoek naar de breathing peak flow bij mannen en vrouwen 
die de oefeningen doen voor en na het uitvoeren van 10 jumping jacks worden 
gepresenteerd aan de hand van de volgende boxplots en histogrammen. De boxplots tonen de verdeling van 
de breathing peak flow in de verschillende groepen. Figuur 1 toont de boxplots 
van de piekstroom bij vrouwen die oefeningen doen voor en na de jumping jacks. 

```{r female-box-plot, fig.align='center'}
#Boxplots of peak flow rate in females that do exercise before and after jumping jacks

ggplot(data = data_breath_female,
       mapping = aes(x = Sex, y = Peak_flow, color = Sex)) +
  geom_boxplot() +
  facet_wrap(~ Has_activity_label + Sporting_label) +
  stat_summary(fun = "mean", geom = "point",
               color = "gold") + xlab("Peak flow rate in females that do exercise before performing 10 jumping jacks")
```

Figuur 2 toont de boxplots van de piekstroom bij mannen die oefeningen doen 
voor en na de jumping jacks.

```{r male-box-plot, fig.align='center'}

ggplot(data = data_breath_male,
       mapping = aes(x = Sex, y = Peak_flow, color = Sex)) +
  geom_boxplot() +
  facet_wrap(~ Has_activity_label + Sporting_label) +
  stat_summary(fun = "mean", geom = "point",
               color = "gold") + xlab("Peak flow rate in males that do exercise before performing 10 jumping jacks")

```


Uit de boxplots blijkt het dat bij zowel mannen als vrouwen de gemiddelde 
piekstroom hoger is na het uitvoeren van de jumping jacks in vergelijking met daarvoor. 
Dit kan worden afgeleid uit de punten die de gemiddelde waarden weergeven, 
die hoger liggen na de jumping jacks. Deze observatie kan suggereren de beoevening van een sport zoals bij ons de jumping jacks 
een positief effect kan hebben op de ademhalingsfunctie.

Om verder inzicht te krijgen in de invloed van sport op de ademhalingsfunctie, 
zijn histogrammen gemaakt om de verdeling van de breathing peak flow te visualiseren 
bij mensen die wel en niet sporten. Figuur 3 toont het histogram van de piekstroom 
bij mensen die sporten, waarbij de gegevens zijn gegroepeerd op basis van sex. 

```{r sporting-histograms, warning=FALSE, fig.cap='A histogram plotted from a data collection with the filter if the person sport grouped by sex'}
data_sporting <- data_breath %>% filter(Sporting == T)

pvalue <- t.test((data_sporting %>% filter(Sex == "Woman"))$Peak_flow, 
y = (data_sporting %>% filter(Sex == "Man"))$Peak_flow)$p.value

# histogram of people that sport
ggplot(data = data_sporting) +
       geom_histogram(mapping = aes(x = Peak_flow,  fill=Sex), bins = 30, position="dodge", right=TRUE) +
       facet_wrap(~ Has_activity_label) +
       labs(fill='Sex',
            x = "Breathing peak flow rate in L/m")
            
pvalue

```

Figuur 4 toont het histogram van de piekstroom bij mensen die niet sporten, ook 
gegroepeerd op basis van geslacht.

```{r no-sporting-histograms, warning=FALSE, fig.cap='A histogram plotted from a data collection with the filter if the person does not sport grouped by sex'}
data_not_sporting <- data_breath %>% filter(Sporting == F)

pvalue <- t.test((data_not_sporting %>% filter(Sex == "Woman"))$Peak_flow, 
y = (data_not_sporting %>% filter(Sex == "Man"))$Peak_flow)$p.value

#verschil tussen de verschillende sexsen', fig.cap='T-test of er een verschil in peakflow zit bij mannen en bij vrouwen'

# histogram of people that do not sport
ggplot(data = data_not_sporting) +
       geom_histogram(mapping = aes(x = Peak_flow,  fill=Sex), bins = 30, position="dodge", right=TRUE) +
       facet_wrap(~ Has_activity_label) +
       labs(fill='Sex',
            x = "Breathing peak flow rate in L/m",
       alt = "A histogram plotted from a data collection with the filter if the person does not sport grouped by sex")
```

Als er dichter wordt gekeken naar de histogrammen blijkt dat bij zowel mannen als vrouwen die sporten, 
de breathing peak flow over het algemeen hoger zijn in vergelijking met mensen 
die niet sporten. Dit kan suggereren dat regelmatige lichaamsbeweging een positieve 
invloed kan hebben op de ademhalingsfunctie. Bovendien is te zien dat bij 
zowel mannen als vrouwen de verdeling van de breathing peak flow hoger is 
bij mensen die sporten in vergelijking met degenen die niet sporten. Waarbij je 
ook ziet dat de breathing peak flow lager is bij mensen die niet sporten na jumping jacks.

De resultaten van dit onderzoek laten zien dat het doen van jumping jacks een 
positief effect kan hebben op de ademhalingsfunctie, aangezien de gemiddelde 
breathing peak flow waarde hoger is na het uitvoeren van de oefening. Daarbij tonen 
de histogrammen aan dat mensen die regelmatig sporten over het algemeen hogere 
breathing peak flow hebben in vergelijking met mensen die niet sporten. 
Deze bevindingen kan suggereren dat regelmatige lichaamsbeweging gunstig kan 
zijn voor de ademhalingsfunctie. Het is belangrijk om op te merken dat de 
resultaten gebaseerd zijn op een kleine data set. Waarbij wij geen mensen met asma hebben gemeten. 
Verder zou een groter onderzoek met een grotere steekproef en controle van andere relevante variabelen kan meer 
inzicht bieden in het verband tussen lichaamsbeweging en ademhalingsfunctie.

### Zijn de datasets normaalverdeeld?
Bij de data worden de testen gedaan op kleinere datasets. De gemeten peak flow wordt hierin verdeeld in de verschillende sexse: man en vrouw. Deze worden vervolgens verdeeld in personen die wel en die niet sporten. Waarbij elk van deze groep weer wordt verdeeld in de gemeten peak flow voor en na de jumping jacks.
```{r normaal_verdeling_van_data, fig.cap='Per verschillende groep de p-value bij een Shapiro-Wilk test'}
data_breath %>% 
  group_by(Sex, Has_activity, Sporting) %>%
  summarise(Pvalue = shapiro.test(Peak_flow)$p.value, 
            group_size = n(),
            .groups = 'keep')%>%
  select(Has_activity, Sex, Sporting, Pvalue)
```
Hieruit kan worden gehaald dat alle mogelijke combinaties een p-value boven de 0.05 hebben, en dus normaal verdeeld zijn.

###### dit moet ff naar de histogram
```{r verschillende t-testen}
#t.test(normaal_verd_ajj$Peak_flow, y= normaal_verd_bjj$Peak_flow, alternative ="two.sided", paired = TRUE)
```

De p-waard is 6.102e-11 dit betekent zoals eerder was benoemdt dat er een significant verschil aanwezig is tussen de peakflow van de mannen en vrouwen.

### Zit er een verschil in peakflow tussen de verschillende groepen voor en na 10 jumping jacks?
Hiernaast wordt er gekeken of er verschillen zitten in de peakflow bij de verschillende groepen voor en na 10 jumping jacks.
```{r verschillende_t.test_op_groepen, fig.cap='De verschillende p-values van de t-testen bij de verschillende groepen voor en na 10 jumping'}
 data_breath %>%
  group_by(Sex, Has_activity, Sporting) %>%
  select(-Has_activity_label) %>%
  pivot_wider(names_from = Has_activity, values_from = Peak_flow) %>%
  summarise(Pvalue = t.test(x = True,y= False, alternative = "two.sided", paired = TRUE)$p.value, 
           group_size = n(),
          .groups = 'keep')%>%
 select(Sex, Sporting, Pvalue)

```
Bij mannen die wel en niet sporten is er geen significant verschil in de peakflow voor de 10 jumping jacks en na de 10 jumping jacks.
Bij brouwen die wel en niet sporten er er wel een significant verschil in de peakflow voor de 10 jumping jacks en na de 1 jumping jacks.

### Is er een effect van de factoren: sportende, uitvoering van kleine sportieve activiteit en geslacht op de gemeten peak flow?

Doormiddel van een ANOVA test wordt de effect van de factoren: sexsen, of de persoon sport en de uitvoering van een kleine sportieve activiteit.
```{r ANOVA, fig.cap='P values voor ANOVA testen van de effecten van sporten, een sportieve activiteit en het geslacht. '}
pvalue <- c()

res_sex_sporting_activity <- summary(aov(Peak_flow ~ Sex + Sporting + Has_activity, data = data_breath))
pvalue[length(pvalue)+1] <- unlist(res_sex_sporting_activity)['Pr(>F)1']

res_man_sporting_activity <- summary(aov(Peak_flow ~ Sporting + Has_activity, data = data_breath_male))
pvalue[length(pvalue)+1] <- unlist(res_man_sporting_activity)['Pr(>F)1']

res_woman_sporting_activity <- summary(aov(Peak_flow ~ Sporting + Has_activity, data = data_breath_female))
pvalue[length(pvalue)+1] <- unlist(res_woman_sporting_activity)['Pr(>F)1']
Soort_variable <- c("sport + geslacht + activiteit", "sport + activiteit bij mannen", "sport + activiteit bij vrouwen")

data.frame(Soort_variable, pvalue)
```
Bij de test waar de factoren: sport, geslacht en activiteit zijn behandeld, is een p-value van 5.046752e-11. Dit betekent dat er een effect van geslacht op de peakflow zit. Daarbij zijn er apparte testen afgenomen om het effect los van het geslacht te bekijken. Maar deze is niet aanwezig.

Geef tabellen bovenaan een titel en bijschrift die de inhoud beschrijft en onderaan voetnoten die kolomnamen of specifieke waardes verklaren.

Deze sectie bevat tussen de 600-1200 woorden.


# Discussie en Conclusies
Gezamelijk hand ik hand
Formuleer je conclusie door eerst in te zoomen op je eigen data en daarna uit te zoomen. Zoom in door je resultaten samen te vatten. Zoom uit om de waarde van je werk te beoordelen, door je bijvoorbeeld de volgende vragen te stellen: 


- Kunnen mijn resultaten gebruikt worden in het werkveld? 
- Wat betekenen ze voor het werkveld? 
- Zijn mijn data betrouwbaar? 

Bespreek de resultaten zodanig dat je ze ter discussie stelt, wees kritisch. Vergelijk je resultaten met de literatuur of eerder ontwikkelde data. Geef aanbevelingen voor een vervolg en staaf je aanbevelingen door de impact op wetenschappelijk of maatschappelijk vlak te beschrijven. 

Kom ten slotte altijd terug op de doelstelling (en hypothesen).

Deze sectie bevat tussen de 400-800 woorden.


# Online bijlagen
Daniel Pastoor
Vaak zijn online bijlagen vele malen groter dan het eigenlijke artikel. Wees nooit bang om te veel aan bijlagen aan te bieden. Je kan hierbij denken aan

- de ruwe data
- de code voor dataverwerking 
- de code voor analyse
- aanvullende figuren en tabellen

Natuurlijk is een git(hub) repo daar de beste plek voor!
Zorg ervoor de je repo logisch is ingericht met goede Readme document(en). 
Ook de code zelf is waar nodig natuurlijk goed gedocumenteerd.

## Wordcount

Voeg aan het eind een woord-telling in:

```{r wordcount, message=FALSE}
wordcountaddin:::text_stats()
```

# Referenties

Een lijst van referenties wordt hier automagisch toegevoegd.
